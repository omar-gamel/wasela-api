# Migration `20200304163140`

This migration has been generated by omar-gamel at 3/4/2020, 4:31:40 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."TaskManager" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "task_id" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."Day" ADD COLUMN "isActive" boolean  NOT NULL DEFAULT true;

ALTER TABLE "public"."Coupon" ADD COLUMN "original_noUse" integer  NOT NULL DEFAULT 0;

ALTER TABLE "public"."Cart" ADD COLUMN "totalPrice" Decimal(65,30)  NOT NULL DEFAULT 0,
ADD COLUMN "totoalQty" integer  NOT NULL DEFAULT 0;

ALTER TABLE "public"."Notification" ADD COLUMN "models" text   ;

ALTER TABLE "public"."NotificationModel" DROP COLUMN "notification";

CREATE UNIQUE INDEX "TaskManager.task_id" ON "public"."TaskManager"("task_id")

ALTER TABLE "public"."Notification" ADD FOREIGN KEY ("models") REFERENCES "public"."NotificationModel"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200304104024..20200304163140
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://postgres:root@localhost:5432/mydb?schema=public"
 }
 generator client {
   provider = "prisma-client-js"
@@ -154,8 +154,9 @@
   lectures    Lecture[]
   assignments Assignment[]
   comments    Comment[]
   reviews     DayReview[]
+  isActive    Boolean      @default(true)
   createdAt   DateTime     @default(now())
   updatedAt   DateTime     @updatedAt
 }
@@ -248,22 +249,23 @@
 // _______________________
 model Coupon {
-  id        String            @id @default(cuid())
-  code      String            @unique
-  isPercent Boolean
-  amount    Float
-  startDate DateTime
-  endDate   DateTime
-  isActive  Boolean           @default(true)
-  user      User
-  courses   Course[]
-  paths     Path[]
-  type      CouponAppliedType
-  noUse     Int
-  createdAt DateTime          @default(now())
-  updatedAt DateTime          @updatedAt
+  id             String            @id @default(cuid())
+  code           String            @unique
+  isPercent      Boolean
+  amount         Float
+  startDate      DateTime
+  endDate        DateTime
+  isActive       Boolean           @default(true)
+  user           User
+  courses        Course[]
+  paths          Path[]
+  type           CouponAppliedType
+  original_noUse Int
+  noUse          Int               @default(0)
+  createdAt      DateTime          @default(now())
+  updatedAt      DateTime          @updatedAt
 }
 enum CouponAppliedType {
   COURSES PATHS
@@ -271,13 +273,15 @@
 // _______________________
 model Cart {
-  id        String     @id @default(cuid())
-  user      User
-  items     CartItem[]
-  createdAt DateTime   @default(now())
-  updatedAt DateTime   @updatedAt
+  id         String     @id @default(cuid())
+  user       User
+  items      CartItem[]
+  totoalQty  Int
+  totalPrice Float
+  createdAt  DateTime   @default(now())
+  updatedAt  DateTime   @updatedAt
 }
 model CartItem {
   id        String   @id @default(cuid())
@@ -521,9 +525,9 @@
 model Notification {
   id        String                  @id @default(cuid())
   message   String
   to        NotificationRecipient[]
-  models    NotificationModel[]
+  models    NotificationModel?
   type      NotificationType
   createdAt DateTime                @default(now())
   updatedAt DateTime                @updatedAt
 }
@@ -554,5 +558,14 @@
   id        String   @id @default(cuid())
   student   User
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
+}
+
+// _______________________
+
+model TaskManager {
+  id        String   @id @default(cuid())
+  task_id   String   @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
 }
```


